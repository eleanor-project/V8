# ELEANOR V8 - Secrets Management Configuration

secrets:
  # Provider selection: environment, aws, vault
  provider: environment  # Override with ENV: SECRETS_PROVIDER
  
  # AWS Secrets Manager configuration
  aws:
    enabled: false
    region: us-west-2
    cache_ttl: 300  # Cache secrets for 5 minutes
    
    # Secret names in AWS Secrets Manager
    secret_mappings:
      openai_api_key: "eleanor/prod/openai-api-key"
      anthropic_api_key: "eleanor/prod/anthropic-api-key"
      database_password: "eleanor/prod/database-password"
  
  # HashiCorp Vault configuration
  vault:
    enabled: false
    addr: "${VAULT_ADDR}"  # https://vault.example.com
    token: "${VAULT_TOKEN}"
    mount_point: "secret"  # KV v2 mount point
    cache_ttl: 300
    
    # Secret paths in Vault
    secret_mappings:
      openai_api_key: "eleanor/openai-api-key"
      anthropic_api_key: "eleanor/anthropic-api-key"
      database_password: "eleanor/database-password"
  
  # Environment variables (development only)
  environment:
    prefix: "ELEANOR_"  # Only load vars with this prefix

# Sanitization settings
sanitization:
  # Enable automatic sanitization
  enabled: true
  
  # Sanitize evidence recordings
  sanitize_evidence: true
  
  # Sanitize error messages
  sanitize_errors: true
  
  # Sanitize debug output
  sanitize_debug: true
  
  # Additional sensitive key patterns
  custom_sensitive_keys:
    - "internal_token"
    - "signing_key"
    - "encryption_key"
  
  # Log sanitization events (for debugging)
  log_sanitization: false

# Security audit logging
audit:
  # Log secret access
  log_secret_access: true
  
  # Log sanitization events
  log_sanitization_events: false
  
  # Audit log file
  audit_log_path: "logs/security_audit.log"
